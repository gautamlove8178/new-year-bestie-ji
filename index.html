<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marya üíñ ‚Äî Happy New Year</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:'Segoe UI',sans-serif;}

/* Buttons */
.btn{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  padding:clamp(12px,4vw,20px) clamp(20px,6vw,40px);
  font-size:clamp(1rem,5vw,1.8rem);cursor:pointer;border:none;border-radius:12px;
  background:#ff3399;color:#fff;z-index:20;box-shadow:0 0 25px #ff66aa;transition:0.3s;}
.btn:active{transform:translate(-50%,-50%) scale(1.05);}

/* GIFs */
#introGif,#finalGif{position:absolute;left:50%;transform:translateX(-50%);
  border-radius:15px;box-shadow:0 0 20px #ff66aa;
  opacity:0;transition:opacity 1.5s ease-in-out;z-index:19;max-width:90%;height:auto;}
#introGif{top:72%;}#finalGif{bottom:3%;}

/* Video Slideshow */
.slideshow{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;z-index:1;opacity:0;transition:opacity 2s ease-in-out;}
.slideshow.active{opacity:1;}
.slideshow video{width:100%;height:100%;object-fit:cover;will-change:transform,opacity;transform:translateZ(0);}

/* Stars */
.stars{position:fixed;top:0;left:0;width:100%;height:100%;z-index:2;
  background:transparent url("https://www.transparenttextures.com/patterns/stardust.png") repeat;
  filter:blur(0.5px);animation:moveStars 60s linear infinite;opacity:0;transition:opacity 2s;}
.stars.active{opacity:1;}
@keyframes moveStars{0%{background-position:0 0;}100%{background-position:-10000px 5000px;}}

/* Floating hearts */
.heart{position:absolute;color:#ff99cc;font-size:20px;opacity:0.8;
  filter:drop-shadow(0 0 10px #ff66aa);z-index:6;pointer-events:none;}

/* ‚úÖ Single Message Box Optimized with Typing Style */
#messageBox{
  position:absolute;top:45%;left:50%;
  transform:translate(-50%,-50%);
  color:#fff;text-align:center;
  font-size:clamp(1.2rem,6vw,2rem);
  opacity:0;max-width:90%;
  text-shadow:0 0 15px #ff6699,0 0 25px #ff99cc;
  z-index:10;transition:opacity 1s ease-in-out;
  white-space:pre-line;
  line-height:1.9;
  font-weight:500;
}
#messageBox.show{opacity:1;}
#messageBox.finale{font-size:clamp(1.8rem,7vw,2.8rem);
  text-shadow:0 0 20px #ff99cc,0 0 40px #fff,0 0 60px #ff6699;}

/* Fireworks canvas */
canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:5;pointer-events:none;}

/* Cake */
#cakeContainer{position:absolute;bottom:10%;left:50%;transform:translateX(-50%);
  z-index:15;display:none;width:180px;height:140px;}
.cake{position:relative;width:100%;height:100%;}
.layer{position:absolute;left:50%;transform:translateX(-50%);border-radius:15px;}
.layer.bottom{bottom:0;width:100%;height:60%;background:linear-gradient(#ffdee9,#b5fffc);}
.layer.top{bottom:45%;width:80%;height:40%;background:linear-gradient(#ffd6f6,#ff9cd3);}
.candle{position:absolute;bottom:85%;left:50%;transform:translateX(-50%);
  width:10px;height:40px;background:#fff;border-radius:4px;}
.flame{position:absolute;bottom:115%;left:50%;transform:translateX(-50%);
  width:20px;height:28px;border-radius:50%;
  background:radial-gradient(circle at 40% 30%,#fff,#ff0 20%,#f80 60%,transparent 70%);
  animation:flicker .8s infinite,pulse 1.2s infinite alternate;}
@keyframes flicker{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.1)}}
@keyframes pulse{from{filter:brightness(1)}to{filter:brightness(1.6)}}
.slice{position:absolute;top:0;left:50%;width:0;height:100%;background:#ff3399;
  transform-origin:left bottom;transform:rotate(0deg);border-radius:0 15px 15px 0;}
@keyframes sliceCut{0%{width:0;transform:rotate(0deg);}60%{width:55%;transform:rotate(-25deg);}80%{width:50%;transform:rotate(-20deg);}100%{width:50%;transform:rotate(-20deg);}}

/* Additional styles from second code */
.container{
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:30px;
  z-index:10;
  position: relative;
}
.text{
  max-width:700px;
  font-size:22px;
  line-height:1.9;
  white-space:pre-line;
  text-shadow:0 0 12px rgba(0,0,0,.9);
  opacity:1;
  transition:all .8s ease;
  font-weight: 500;
}
.end{
  font-size:26px;
  text-align:center;
  animation:glow 2s ease infinite alternate;
}
@keyframes glow{
  from{text-shadow:0 0 10px #ff5fa2}
  to{text-shadow:0 0 30px #ff9bd1}
}
#proposal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.9);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:20;
}
#proposal div{
  text-align:center;
  font-size:28px;
  animation:fadeIn 2s ease forwards;
  padding: 20px;
}
@keyframes fadeIn{
  from{opacity:0;transform:scale(.9)}
  to{opacity:1;transform:scale(1)}
}
#newyearFinal{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:25;
  background:rgba(0,0,0,.8);
  flex-direction:column;
}
.smoke{
  font-size:36px;
  font-weight:800;
  letter-spacing:1px;
  color:#fff;
  opacity:0;
  filter:blur(6px);
  animation:smokeIn 4.5s ease forwards;
  text-align: center;
  padding: 10px;
}
@keyframes smokeIn{
  0%{opacity:0;filter:blur(15px);transform:translateY(30px) scale(0.96)}
  60%{opacity:1;filter:blur(4px)}
  100%{opacity:1;filter:blur(0);transform:translateY(0) scale(1)}
}
</style>
</head>
<body>

<div class="slideshow" id="slideshow">
  <video id="bgVideo" autoplay loop muted playsinline preload="auto">
    <source src="your-video.mp4" type="video/mp4">
  </video>
</div>
<div class="stars" id="stars"></div>
<img src="intro.gif" id="introGif">
<img src="anniversary.gif" id="finalGif">

<button id="turnOnLight" class="btn">Turn on the light üí°</button>
<button id="startBtn" class="btn" style="display:none;">Start karo meri jaan üòòüíñ</button>

<!-- ‚úÖ Single box for all messages with typing -->
<div id="messageBox"></div>

<div id="cakeContainer">
  <div class="cake">
    <div class="layer bottom"></div>
    <div class="layer top"></div>
    <div class="candle"></div>
    <div class="flame"></div>
    <div class="slice" id="slice"></div>
  </div>
</div>

<canvas id="fireworks"></canvas>
<canvas id="particles"></canvas>
<audio id="bg-music" src="romantic.mp3"></audio>

<div id="proposal">
  <div>
    üíç<br><br>
    Marya,<br>
    will you stay with me‚Ä¶<br>
    every year, every version of me? ‚ù§Ô∏è
  </div>
</div>

<div id="newyearFinal">
  <div class="smoke">‚ú®üíñ HAPPY NEW YEAR MARYA üíñ‚ú®</div>
</div>

<script>
const turnOnBtn=document.getElementById("turnOnLight");
const startBtn=document.getElementById("startBtn");
const slideshow=document.getElementById("slideshow");
const stars=document.getElementById("stars");
const bgMusic=document.getElementById("bg-music");
const introGif=document.getElementById("introGif");
const finalGif=document.getElementById("finalGif");
const cakeContainer=document.getElementById("cakeContainer");
const slice=document.getElementById("slice");
const messageBox=document.getElementById("messageBox");

// Messages from second code with typing style
const lines=[
`Marya,

Main zyada bol nahi paata.
Main cheezein achhe se express bhi nahi kar paata.`,

`Par jab main chup hota hoon na,
tab bhi mere andar
tum chal rahi hoti ho.`,

`Main strong dikhne ki koshish karta hoon,
par sach ye hai ki
tumhare bina main adhoora ho jaata hoon.`,

`Tum sirf meri life ka hissa nahi ho,
tum wo jagah ho
jahan main thak ke rukta hoon.`,

`Agar kabhi poochha jaaye
main kya chahta hoon,
toh jawab bahut simple hai‚Ä¶`,

`main chahta hoon
ki har saal,
har din,
har haal mein
tum mere paas raho.`,

`main chahta hoon
ki hum saath mein,
bahut maze karein aur
ghumte rahe puri duniya.`,

`Ab tum bas mere pass jaldi aao,
meri marya mera maa
tumhara baccha intezaar kar raha hai.`,

`<div class="end">
Marya,<br><br>
tum mere liye<br><b>sab kuch ho.</b><br><br>
‚Äî Love Gautam
</div>`
];

// Typing function from second code
function typeText(content){
  messageBox.innerHTML=""
  const plain=content.replace(/<[^>]*>/g,"")
  let j=0; typing=true
  const t=setInterval(()=>{
    messageBox.textContent=plain.slice(0,j++)
    if(j>plain.length){
      clearInterval(t)
      messageBox.innerHTML=content
      typing=false
    }
  },35) 
}

// Turn on lights
turnOnBtn.onclick=()=>{
  slideshow.classList.add("active");
  stars.classList.add("active");
  bgMusic.play();
  turnOnBtn.style.display="none";
  startBtn.style.display="block";
  introGif.style.opacity=1;
};

// Start animation
startBtn.onclick=()=>{
  startBtn.style.display="none";
  introGif.style.opacity=0;
  setTimeout(()=>startTimeline(),1500);
};

// ‚úÖ Modified showMessage with typing
let currentIndex = 0;
let typing = false;

function showMessage(){
  if (currentIndex < lines.length) {
    messageBox.className = "show";
    typeText(lines[currentIndex]);
    setTimeout(() => {
      messageBox.classList.remove("show");
      currentIndex++;
      if (currentIndex < lines.length) {
        setTimeout(showMessage, 1000); // Delay before next message
      } else {
        // After all messages, show proposal
        setTimeout(() => {
          document.getElementById("proposal").style.display = "flex";
          launchFireworks();
          setTimeout(() => {
            document.getElementById("proposal").style.display = "none";
            document.getElementById("newyearFinal").style.display = "flex";
            launchFireworks();
          }, 5000);
        }, 2000);
      }
    }, 10000); // Time to show each message
  }
}

function startTimeline(){
  showMessage();
}

// Hearts from first code
let hearts=[];
function createHeart(){
  if(hearts.length>20)return;
  const h={x:Math.random()*window.innerWidth,y:window.innerHeight+20,size:Math.random()*12+12,speed:Math.random()*1+0.5,el:document.createElement("div")};
  h.el.className="heart";h.el.style.left=h.x+"px";h.el.style.top=h.y+"px";h.el.style.fontSize=h.size+"px";
  h.el.innerHTML="üíñ";document.body.appendChild(h.el);hearts.push(h);
}
function animateHearts(){
  for(let i=hearts.length-1;i>=0;i--){const h=hearts[i];h.y-=h.speed;h.el.style.top=h.y+"px";if(h.y<-50){h.el.remove();hearts.splice(i,1);} }
  if(Math.random()<0.02)createHeart();requestAnimationFrame(animateHearts);
}
animateHearts();

// Fireworks from first code
const canvas=document.getElementById("fireworks");const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;canvas.height=window.innerHeight;
window.addEventListener("resize",()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;});
function random(min,max){return Math.random()*(max-min)+min;}
class Particle{
  constructor(x,y,color){this.x=x;this.y=y;this.color=color;this.radius=random(2,4);this.alpha=1;this.vx=random(-3,3);this.vy=random(-3,3);}
  update(){this.x+=this.vx;this.y+=this.vy;this.alpha-=0.02;}
  draw(){ctx.globalAlpha=this.alpha;ctx.fillStyle=this.color;ctx.beginPath();ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);ctx.fill();ctx.globalAlpha=1;}
}
let particles=[];
function launchFireworks(){
  requestAnimationFrame(function f(){
    if(Math.random()<0.02){
      const x=random(100,canvas.width-100);const y=random(100,canvas.height/2);
      const colors=["#ff99cc","#ff3366","#ffffff","#ff6699","#ffccff"];
      for(let i=0;i<20;i++){particles.push(new Particle(x,y,colors[Math.floor(Math.random()*colors.length)]));}
    }
    requestAnimationFrame(f);
  });
}
function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for(let i=particles.length-1;i>=0;i--){const p=particles[i];p.update();p.draw();if(p.alpha<=0)particles.splice(i,1);}
  requestAnimationFrame(animateParticles);
}
launchFireworks();animateParticles();

// Particles from second code
const pc=document.getElementById("particles")
const pctx=pc.getContext("2d")
function resizeP(){pc.width=innerWidth;pc.height=innerHeight}
resizeP();onresize=resizeP

let partParticles=[]
for(let i=0;i<120;i++){
  partParticles.push({
    x:Math.random()*pc.width,
    y:Math.random()*pc.height,
    r:Math.random()*2+0.5,
    s:Math.random()*0.8+0.2
  })
}

function animParticles(){
  pctx.clearRect(0,0,pc.width,pc.height)
  partParticles.forEach(p=>{
    pctx.fillStyle="rgba(255,255,255,.8)"
    pctx.beginPath()
    pctx.arc(p.x,p.y,p.r,0,Math.PI*2)
    pctx.fill()
    p.y-=p.s
    if(p.y<0) p.y=pc.height
  })
  requestAnimationFrame(animParticles)
}
animParticles()
</script>
</body>
</html>